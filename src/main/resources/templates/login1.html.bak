<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type” content=”text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Title</title>
    <link rel="stylesheet" th:href="@{/layui/css/layui.css}">
    <link rel="stylesheet" th:href="@{/css/index.css}">

</head>
<body>
<div class="video_mask"></div>
<div class="login">
    <h1>道道通-管理登录</h1>
    <form class="layui-form">
        <div class="layui-form-item">
            <input class="layui-input" id="username" name="username" placeholder="用户名" lay-verify="required" type="text" autocomplete="off">
        </div>
        <div class="layui-form-item">
            <input class="layui-input" id="password" name="password" placeholder="密码" lay-verify="required" type="password" autocomplete="off">
        </div>
        <div class="layui-form-item form_code">
            <input class="layui-input" id="code" name="code" placeholder="验证码" lay-verify="required" type="text" autocomplete="off">
            <div class="code"><img id="imgObj" src="/init/code" th:onclick="'changeImg()'"  width="116" height="36"/></div>
        </div>
        <button class="layui-btn login_btn" lay-submit="" lay-filter="login">登录</button>
    </form>
</div>
<script th:src="@{/layui/layui.js}" type="text/javascript"></script>
<script th:src="@{/js/jquery-2.1.4.min.js}" type="text/javascript"></script>
<script type="text/javascript">
    var form = '';
    //Demo
    layui.use('form', function(){
        form = layui.form;
        // form.render();
        //监听提交
        form.on('submit(login)', function(data){
            $(this).text("登录中...").attr("disabled", "disabled").addClass("layui-disabled");
            var username = $('input[name=username]').val();
            var password = $('input[name=password]').val();
            var code = $('input[name=code]').val();
            var dt = {
                'username':username,
                'password':password,
                'code':code
            };
            $.ajax({
                url:'/init/loginTo',
                type:'POST',
                data:dt,
                success:function (data) {
                    alert(data);
                    if(data == 'success'){
                        location.href = '/adminInit/init';
                    }
                    return false;
                }
            });
            return false;
        });
    });


    /**
     * 登录事件
     */
    function login(data) {

    }

    function changeImg() {
        var imgSrc = $("#imgObj");
        var src = imgSrc.attr("src");
        imgSrc.attr("src", src+"?"+Math.random());
    }
</script>
</body>


</html>